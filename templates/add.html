<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Cadastrar Comércio — BANKA</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="/static/style.css">
	<script defer src="/static/script.js"></script>
</head>
<body>
	<header class="site-header">
		<div class="container header-inner">
			<div class="brand">
				<svg width="34" height="34" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
					<rect x="1" y="1" width="22" height="22" rx="6" fill="#FFD700" />
					<path d="M7 17L11 7L13 12L17 5" stroke="#6B3410" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
				</svg>
				<span class="brand-name">BANKA</span>
			</div>
			<nav class="nav">
				<a class="btn btn-ghost" href="/produtos">Explorar</a>
				<a class="btn btn-outline" href="/">Início</a>
			</nav>
		</div>
	</header>

	<main class="container">
		<h2>Cadastro de Comércio</h2>
		<p class="muted">Preencha as informações do seu ponto de venda.</p>
		<form id="add-form" class="crud-form">
			<div class="form-group">
				<label>Nome</label>
				<input name="nome" required />
			</div>
			<div class="form-group">
				<label>Local</label>
				<input name="local" />
			</div>
			<div class="form-group">
				<label>Horário</label>
				<input name="horario" />
			</div>
			<div class="form-group">
				<label>Produtos (separados por vírgula)</label>
				<input name="produtos" placeholder="ex: Queijo, Pão, Mel" />
			</div>
			<div class="form-actions">
				<button type="submit" class="btn btn-primary">Cadastrar</button>
				<a class="btn btn-ghost" href="/produtos">Voltar</a>
			</div>
		</form>
		<script>
			document.addEventListener('DOMContentLoaded', function(){
				const form = document.getElementById('add-form');
				form.addEventListener('submit', function(e){
					e.preventDefault();
					const fd = new FormData(form);
					const payload = {
						nome: fd.get('nome'),
						local: fd.get('local'),
						horario: fd.get('horario'),
						produtos: (fd.get('produtos') || '').split(',').map(s => s.trim()).filter(Boolean)
					};
					fetch('/api/comercios', {
						method: 'POST',
						headers: { 'Content-Type': 'application/json' },
						body: JSON.stringify(payload)
					}).then(r => r.json()).then(()=>{
						showToast('Comércio cadastrado!');
						window.location.href = '/produtos';
					}).catch(err=>{ console.error(err); showToast('Erro ao cadastrar'); });
				});
			});
		</script>
	</main>

	<footer class="site-footer">
		<div class="container">
			<p class="muted">&copy; BANKA</p>
		</div>
	</footer>

	<div id="toast" class="toast" aria-live="polite"></div>
</body>
</html>
